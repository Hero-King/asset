import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as s,e as h,b as l,r as t,o as p}from"./app-CY6z3zXA.js";const o={};function k(r,i){const a=t("Mermaid");return p(),n("div",null,[i[0]||(i[0]=s("h1",{id:"webhook",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#webhook"},[s("span",null,"Webhook")])],-1)),i[1]||(i[1]=s("h2",{id:"什么是-webhook",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#什么是-webhook"},[s("span",null,"什么是 webhook")])],-1)),i[2]||(i[2]=s("p",null,"Webhook 是一种 HTTP 回调机制，允许应用程序在特定事件发生时向预定义的 URL 发送实时通知。此机制实现了系统之间的自动数据交换和实时通信。",-1)),h(a,{code:"eJwrTi0sTc1LTnXJTEwvSszlUgCCgsSikszkzILEvBKF4PzSouRUheDK4pJUTNmQxKL0VKAiiCxYGkWDrp0dCt9K4cmu7ie7tz3tn/h8ynxi1D+b1/J09y4Fj5CQAIUA/+AQhRfrtz/b2IRVK4prrBSAlrxsaFQoT03KyM/PRtaIohCLxiUtzye0QdQ/m7rhWe86LLownfpi/5Sns+c9ndz7dNeU93s6XjbMerpjx7MZ6xWMKioUnndte9bQ+HxB4/s9nZCASswpgbrp6ZKNL7YsBQsSESJP1817Nm3vy/beF+unPpuz62nHNrDO1LwULgCZkMK/"}),i[3]||(i[3]=l(`<ol><li>在源系统中发生特定事件</li><li>源系统构建包含事件数据的 HTTP POST 请求</li><li>源系统将请求发送到预配置的目标系统 URL</li><li>目标系统接收请求并处理数据</li><li>目标系统向源系统返回响应</li><li>如果请求失败，源系统可以实施重试机制</li></ol><h2 id="实施-webhook-的最佳实践是什么" tabindex="-1"><a class="header-anchor" href="#实施-webhook-的最佳实践是什么"><span>实施 webhook 的最佳实践是什么？</span></a></h2><p>当你是 webhook 的发送者（生产者）时，考虑以下方面:</p><h3 id="webhook-设计" tabindex="-1"><a class="header-anchor" href="#webhook-设计"><span>Webhook 设计</span></a></h3><ul><li>定义清晰的事件类型：例如，order.created，user.updated 等。</li><li>使用标准 JSON 格式：确保数据结构清晰且易于解析。</li><li>版本控制：在请求头或负载中包含版本信息。</li><li>提供足够的上下文：包括事件发生的时间戳、相关资源的唯一标识符等。</li></ul><h3 id="发送机制" tabindex="-1"><a class="header-anchor" href="#发送机制"><span>发送机制</span></a></h3><p>实施可靠的 webhook 发送机制：</p><ul><li>使用异步任务队列：避免阻塞主程序并提高系统响应能力。</li><li>实施重试机制：处理网络故障或接收者的临时不可用。</li></ul><h3 id="重试策略" tabindex="-1"><a class="header-anchor" href="#重试策略"><span>重试策略</span></a></h3><p>设计合适的重试策略：</p><ul><li>实施指数退避：避免频繁重试对系统和接收者造成压力。</li><li>设置最大重试次数：防止无限重试消耗系统资源。</li><li>提供手动重试机制：为最终失败的 webhook 提供手动重试的接口。</li></ul><h3 id="安全实施" tabindex="-1"><a class="header-anchor" href="#安全实施"><span>安全实施</span></a></h3><p>实施签名机制以允许接收者验证请求的真实性</p><h3 id="性能优化" tabindex="-1"><a class="header-anchor" href="#性能优化"><span>性能优化</span></a></h3><p>优化 webhook 发送性能：</p><ul><li>使用连接池：减少建立连接的开销并提高性能。</li><li>实施批处理：在适当时以批处理方式发送 webhook，以减少网络交互次数。</li></ul><h2 id="使用-webhook-的最佳实践是什么" tabindex="-1"><a class="header-anchor" href="#使用-webhook-的最佳实践是什么"><span>使用 webhook 的最佳实践是什么？</span></a></h2><p>当作为接收者（消费者）使用 webhook 时，考虑以下方面：</p><h3 id="安全" tabindex="-1"><a class="header-anchor" href="#安全"><span>安全</span></a></h3><p>由于接收 webhook 的端点通常是公开可访问的，安全是首要考虑的问题。注意以下几点：</p><ul><li><p>验证请求的真实性：实施签名验证机制以确保请求来自预期的发送者。</p><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-javascript"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;crypto&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">function</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> verifySignature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">payload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">secret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> expectedSignature</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> crypto</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">createHmac</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;sha256&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">secret</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;">JSON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">stringify</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">payload</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">digest</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;hex&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> crypto</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">timingSafeEqual</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    Buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">signature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">    Buffer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">expectedSignature</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  );</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>使用 HTTPS：确保你的 webhook 接收端点使用 HTTPS，以防止数据在传输过程中被拦截或篡改。</p></li><li><p>实施 IP 白名单：仅接受来自可信 IP 地址的 webhook 请求，以降低攻击风险。</p></li></ul><h3 id="可靠性" tabindex="-1"><a class="header-anchor" href="#可靠性"><span>可靠性</span></a></h3><p>确保可靠地处理接收到的 webhook：</p><ul><li>实施幂等处理：设计系统以正确处理重复的 webhook 通知，因为发送者可能会重试失败的请求。</li><li>快速响应：在接收到 webhook 请求后立即返回响应（通常是 2xx 状态码），以防止发送者认为请求失败并触发重试。</li></ul><h3 id="性能" tabindex="-1"><a class="header-anchor" href="#性能"><span>性能</span></a></h3><p>保持系统高效运行：</p><ul><li>异步处理：在接收到 webhook 后，在后台执行实际数据处理，而不阻塞响应。</li><li>设置超时限制：为 webhook 处理设置合理的超时时间，以防止长时间运行的任务影响系统性能。</li></ul><h3 id="错误处理" tabindex="-1"><a class="header-anchor" href="#错误处理"><span>错误处理</span></a></h3><p>适当地处理潜在的错误情况：</p><ul><li>日志记录：详细记录接收到的 webhook 请求和处理过程，以便于问题调查。</li><li>优雅降级：在无法处理 webhook 时，具有适当的错误处理机制，以确保系统的其他部分不受影响。</li></ul><h3 id="版本兼容性" tabindex="-1"><a class="header-anchor" href="#版本兼容性"><span>版本兼容性</span></a></h3><p>由于 webhook 格式可能会随时间变化：</p><ul><li>处理版本信息：准备好处理不同版本的 webhook 格式。版本信息通常在 URL 或请求头中提供。</li><li>向后兼容：在更新 webhook 处理逻辑时，确保继续支持旧格式版本。</li></ul><h3 id="监控" tabindex="-1"><a class="header-anchor" href="#监控"><span>监控</span></a></h3><p>持续监控 webhook 的接收和处理：</p><ul><li>设置警报：对异常情况（如高失败率或异常流量）实施实时监控和警报。</li><li>性能指标：跟踪 webhook 处理的性能指标，如响应时间和成功率。</li></ul><blockquote><p>参考: <a href="https://auth-wiki.logto.io/zh/webhook#%E4%BB%80%E4%B9%88%E6%98%AF-webhook" target="_blank" rel="noopener noreferrer">https://auth-wiki.logto.io/zh/webhook#什么是-webhook</a></p></blockquote><h2 id="adnanh-webhook-创建一个-webhook-服务" tabindex="-1"><a class="header-anchor" href="#adnanh-webhook-创建一个-webhook-服务"><span>adnanh/webhook 创建一个 webhook 服务</span></a></h2><p>adnanh/webhook 是一个用 Go 语言编写的轻量级、可配置的工具，它允许你在自己的服务器上创建 HTTP 端点（也称为钩子），通过这些端点来执行预先配置好的命令或脚本。当特定的 HTTP 请求触发这些端点时，webhook 可以运行相应的 shell 命令、脚本或其他程序</p><h3 id="核心功能与运作方式" tabindex="-1"><a class="header-anchor" href="#核心功能与运作方式"><span>核心功能与运作方式</span></a></h3><p>灵活的配置：你可以通过一个配置文件（通常是 JSON 或 YAML 格式）来定义多个钩子（hook），每个钩子指定其唯一的 ID、要执行的命令、参数以及触发规则。</p><p>丰富的参数传递：在配置中，你可以设定将 HTTP 请求中的各种数据（例如头部信息、查询参数、Payload 负载中的特定字段）作为参数传递给要执行的命令。</p><p>可定制的触发规则：你可以为每个钩子设置规则，只有满足这些规则（例如，特定的 HTTP 方法、头部信息、Payload 内容或经过验证的 HMAC 签名）的请求才会触发命令执行</p>`,43))])}const b=e(o,[["render",k]]),g=JSON.parse('{"path":"/software/webhook.html","title":"Webhook","lang":"zh-CN","frontmatter":{"description":"Webhook 什么是 webhook Webhook 是一种 HTTP 回调机制，允许应用程序在特定事件发生时向预定义的 URL 发送实时通知。此机制实现了系统之间的自动数据交换和实时通信。 在源系统中发生特定事件 源系统构建包含事件数据的 HTTP POST 请求 源系统将请求发送到预配置的目标系统 URL 目标系统接收请求并处理数据 目标系统向源...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Webhook\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-24T13:04:31.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"HeroKing\\",\\"url\\":\\"https://github.com/Hero-King\\",\\"email\\":\\"838774057@qq.com\\"}]}"],["meta",{"property":"og:url","content":"https://blog.heroking.top/software/webhook.html"}],["meta",{"property":"og:site_name","content":"HeroKing博客"}],["meta",{"property":"og:title","content":"Webhook"}],["meta",{"property":"og:description","content":"Webhook 什么是 webhook Webhook 是一种 HTTP 回调机制，允许应用程序在特定事件发生时向预定义的 URL 发送实时通知。此机制实现了系统之间的自动数据交换和实时通信。 在源系统中发生特定事件 源系统构建包含事件数据的 HTTP POST 请求 源系统将请求发送到预配置的目标系统 URL 目标系统接收请求并处理数据 目标系统向源..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-11-24T13:04:31.000Z"}],["meta",{"property":"article:modified_time","content":"2025-11-24T13:04:31.000Z"}]]},"git":{"createdTime":1763989471000,"updatedTime":1763989471000,"contributors":[{"name":"HeroKingMini","username":"HeroKingMini","email":"838774057@qq.com","commits":1,"url":"https://github.com/HeroKingMini"}]},"readingTime":{"minutes":4.78,"words":1434},"filePathRelative":"software/webhook.md","excerpt":"\\n<h2>什么是 webhook</h2>\\n<p>Webhook 是一种 HTTP 回调机制，允许应用程序在特定事件发生时向预定义的 URL 发送实时通知。此机制实现了系统之间的自动数据交换和实时通信。</p>\\n<ol>\\n<li>在源系统中发生特定事件</li>\\n<li>源系统构建包含事件数据的 HTTP POST 请求</li>\\n<li>源系统将请求发送到预配置的目标系统 URL</li>\\n<li>目标系统接收请求并处理数据</li>\\n<li>目标系统向源系统返回响应</li>\\n<li>如果请求失败，源系统可以实施重试机制</li>\\n</ol>\\n<h2>实施 webhook 的最佳实践是什么？</h2>","autoDesc":true}');export{b as comp,g as data};
