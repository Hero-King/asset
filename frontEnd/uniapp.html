<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Uniapp | HeroKing的个人笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet">
    <script src="https://hm.baidu.com/hm.js?3691b93bb6fcef0775ef18a936452b97" defer="true"></script>
    <meta name="description" content="学习犹如逆水行舟,不进则退">
    
    <link rel="preload" href="/assets/css/0.styles.51c3fc7f.css" as="style"><link rel="preload" href="/assets/js/app.bdff9417.js" as="script"><link rel="preload" href="/assets/js/2.877b15ed.js" as="script"><link rel="preload" href="/assets/js/1.ee4b0e89.js" as="script"><link rel="preload" href="/assets/js/55.94df427b.js" as="script"><link rel="prefetch" href="/assets/js/10.215a54c0.js"><link rel="prefetch" href="/assets/js/100.ca9fb9ed.js"><link rel="prefetch" href="/assets/js/11.5c0721a6.js"><link rel="prefetch" href="/assets/js/12.816525e0.js"><link rel="prefetch" href="/assets/js/13.5bb3cc0b.js"><link rel="prefetch" href="/assets/js/14.967d4b24.js"><link rel="prefetch" href="/assets/js/15.cdbcacd7.js"><link rel="prefetch" href="/assets/js/16.6ed14be5.js"><link rel="prefetch" href="/assets/js/17.2b37666b.js"><link rel="prefetch" href="/assets/js/18.59de2166.js"><link rel="prefetch" href="/assets/js/19.24ad168e.js"><link rel="prefetch" href="/assets/js/20.efb5ce8c.js"><link rel="prefetch" href="/assets/js/21.bae87a1d.js"><link rel="prefetch" href="/assets/js/22.5b821325.js"><link rel="prefetch" href="/assets/js/23.afa22431.js"><link rel="prefetch" href="/assets/js/24.43f77498.js"><link rel="prefetch" href="/assets/js/25.24451938.js"><link rel="prefetch" href="/assets/js/26.3853f613.js"><link rel="prefetch" href="/assets/js/27.e75dcd38.js"><link rel="prefetch" href="/assets/js/28.063c60f6.js"><link rel="prefetch" href="/assets/js/29.7220554b.js"><link rel="prefetch" href="/assets/js/3.b50983ee.js"><link rel="prefetch" href="/assets/js/30.4ed33175.js"><link rel="prefetch" href="/assets/js/31.43c75735.js"><link rel="prefetch" href="/assets/js/32.8b320e32.js"><link rel="prefetch" href="/assets/js/33.a70cfed4.js"><link rel="prefetch" href="/assets/js/34.0d1215c8.js"><link rel="prefetch" href="/assets/js/35.b421a23a.js"><link rel="prefetch" href="/assets/js/36.001d9072.js"><link rel="prefetch" href="/assets/js/37.0778638c.js"><link rel="prefetch" href="/assets/js/38.3e0e2abd.js"><link rel="prefetch" href="/assets/js/39.2b5e1e6a.js"><link rel="prefetch" href="/assets/js/4.30e44ed7.js"><link rel="prefetch" href="/assets/js/40.ec0e2247.js"><link rel="prefetch" href="/assets/js/41.6740da22.js"><link rel="prefetch" href="/assets/js/42.9cb54dd6.js"><link rel="prefetch" href="/assets/js/43.79357489.js"><link rel="prefetch" href="/assets/js/44.baf4bea6.js"><link rel="prefetch" href="/assets/js/45.47988f09.js"><link rel="prefetch" href="/assets/js/46.c89f87a7.js"><link rel="prefetch" href="/assets/js/47.da62c525.js"><link rel="prefetch" href="/assets/js/48.14e8582a.js"><link rel="prefetch" href="/assets/js/49.43c1e6d9.js"><link rel="prefetch" href="/assets/js/5.f3b2a75f.js"><link rel="prefetch" href="/assets/js/50.df122a49.js"><link rel="prefetch" href="/assets/js/51.76c5f73e.js"><link rel="prefetch" href="/assets/js/52.3355c42f.js"><link rel="prefetch" href="/assets/js/53.11e5b2b8.js"><link rel="prefetch" href="/assets/js/54.fbeb759b.js"><link rel="prefetch" href="/assets/js/56.6d2f2843.js"><link rel="prefetch" href="/assets/js/57.8fe877e7.js"><link rel="prefetch" href="/assets/js/58.a1c615a5.js"><link rel="prefetch" href="/assets/js/59.3a72ea1c.js"><link rel="prefetch" href="/assets/js/6.5029a450.js"><link rel="prefetch" href="/assets/js/60.f69daa05.js"><link rel="prefetch" href="/assets/js/61.4558d16e.js"><link rel="prefetch" href="/assets/js/62.b8c4d998.js"><link rel="prefetch" href="/assets/js/63.62f73f54.js"><link rel="prefetch" href="/assets/js/64.294cd3d5.js"><link rel="prefetch" href="/assets/js/65.03979f20.js"><link rel="prefetch" href="/assets/js/66.185be225.js"><link rel="prefetch" href="/assets/js/67.00843cab.js"><link rel="prefetch" href="/assets/js/68.556f46d8.js"><link rel="prefetch" href="/assets/js/69.4d5aed6d.js"><link rel="prefetch" href="/assets/js/7.527d71e0.js"><link rel="prefetch" href="/assets/js/70.97532d18.js"><link rel="prefetch" href="/assets/js/71.3012cf0f.js"><link rel="prefetch" href="/assets/js/72.fb48c1c2.js"><link rel="prefetch" href="/assets/js/73.ce17bb0a.js"><link rel="prefetch" href="/assets/js/74.2d51ded9.js"><link rel="prefetch" href="/assets/js/75.9ce74516.js"><link rel="prefetch" href="/assets/js/76.0d01a419.js"><link rel="prefetch" href="/assets/js/77.1f01c28c.js"><link rel="prefetch" href="/assets/js/78.82e62087.js"><link rel="prefetch" href="/assets/js/79.9d345606.js"><link rel="prefetch" href="/assets/js/80.203e0c71.js"><link rel="prefetch" href="/assets/js/81.ea683e7e.js"><link rel="prefetch" href="/assets/js/82.00e87cdd.js"><link rel="prefetch" href="/assets/js/83.a4eb7ec6.js"><link rel="prefetch" href="/assets/js/84.43cc0681.js"><link rel="prefetch" href="/assets/js/85.685ee0bd.js"><link rel="prefetch" href="/assets/js/86.520d03d8.js"><link rel="prefetch" href="/assets/js/87.3be2955b.js"><link rel="prefetch" href="/assets/js/88.c399e81d.js"><link rel="prefetch" href="/assets/js/89.5e231fc1.js"><link rel="prefetch" href="/assets/js/90.43afd087.js"><link rel="prefetch" href="/assets/js/91.2b3dfc23.js"><link rel="prefetch" href="/assets/js/92.369c0e09.js"><link rel="prefetch" href="/assets/js/93.bb9d94ae.js"><link rel="prefetch" href="/assets/js/94.c39d6dca.js"><link rel="prefetch" href="/assets/js/95.b2ef8bdc.js"><link rel="prefetch" href="/assets/js/96.d9718865.js"><link rel="prefetch" href="/assets/js/97.a32df49d.js"><link rel="prefetch" href="/assets/js/98.e43ebad4.js"><link rel="prefetch" href="/assets/js/99.7ecb8c5a.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.2f354cfa.js">
    <link rel="stylesheet" href="/assets/css/0.styles.51c3fc7f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HeroKing的个人笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="afterEnd" class="dropdown-title"><span class="title">afterEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="afterEnd" class="mobile-dropdown-title"><span class="title">afterEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/afterEnd/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/JMS/" class="nav-link">
  JMS
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/" class="nav-link">
  After End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithms" class="dropdown-title"><span class="title">algorithms</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithms" class="mobile-dropdown-title"><span class="title">algorithms</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  Algorithms
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontEnd" class="dropdown-title"><span class="title">frontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontEnd" class="mobile-dropdown-title"><span class="title">frontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/autojs/" class="nav-link">
  Autojs
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/demo/" class="nav-link">
  Demo
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/" class="nav-link router-link-active">
  Front End
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/ts/" class="nav-link">
  Ts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="life" class="dropdown-title"><span class="title">life</span> <span class="arrow down"></span></button> <button type="button" aria-label="life" class="mobile-dropdown-title"><span class="title">life</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/" class="nav-link">
  Life
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="network" class="dropdown-title"><span class="title">network</span> <span class="arrow down"></span></button> <button type="button" aria-label="network" class="mobile-dropdown-title"><span class="title">network</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/network/proxy/" class="nav-link">
  Proxy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="software" class="dropdown-title"><span class="title">software</span> <span class="arrow down"></span></button> <button type="button" aria-label="software" class="mobile-dropdown-title"><span class="title">software</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/software/ftp/" class="nav-link">
  Ftp
</a></li><li class="dropdown-item"><!----> <a href="/software/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/software/samba/" class="nav-link">
  Samba
</a></li><li class="dropdown-item"><!----> <a href="/software/" class="nav-link">
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="system" class="dropdown-title"><span class="title">system</span> <span class="arrow down"></span></button> <button type="button" aria-label="system" class="mobile-dropdown-title"><span class="title">system</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/system/Hackintosh/" class="nav-link">
  Hackintosh
</a></li><li class="dropdown-item"><!----> <a href="/system/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/system/" class="nav-link">
  System
</a></li><li class="dropdown-item"><!----> <a href="/system/windows/" class="nav-link">
  Windows
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="afterEnd" class="dropdown-title"><span class="title">afterEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="afterEnd" class="mobile-dropdown-title"><span class="title">afterEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/afterEnd/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/JMS/" class="nav-link">
  JMS
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/" class="nav-link">
  After End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithms" class="dropdown-title"><span class="title">algorithms</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithms" class="mobile-dropdown-title"><span class="title">algorithms</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  Algorithms
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontEnd" class="dropdown-title"><span class="title">frontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontEnd" class="mobile-dropdown-title"><span class="title">frontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/autojs/" class="nav-link">
  Autojs
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/demo/" class="nav-link">
  Demo
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/express/" class="nav-link">
  Express
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/" class="nav-link router-link-active">
  Front End
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/ts/" class="nav-link">
  Ts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="life" class="dropdown-title"><span class="title">life</span> <span class="arrow down"></span></button> <button type="button" aria-label="life" class="mobile-dropdown-title"><span class="title">life</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/" class="nav-link">
  Life
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="network" class="dropdown-title"><span class="title">network</span> <span class="arrow down"></span></button> <button type="button" aria-label="network" class="mobile-dropdown-title"><span class="title">network</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/network/proxy/" class="nav-link">
  Proxy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="software" class="dropdown-title"><span class="title">software</span> <span class="arrow down"></span></button> <button type="button" aria-label="software" class="mobile-dropdown-title"><span class="title">software</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/software/ftp/" class="nav-link">
  Ftp
</a></li><li class="dropdown-item"><!----> <a href="/software/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/software/samba/" class="nav-link">
  Samba
</a></li><li class="dropdown-item"><!----> <a href="/software/" class="nav-link">
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="system" class="dropdown-title"><span class="title">system</span> <span class="arrow down"></span></button> <button type="button" aria-label="system" class="mobile-dropdown-title"><span class="title">system</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/system/Hackintosh/" class="nav-link">
  Hackintosh
</a></li><li class="dropdown-item"><!----> <a href="/system/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/system/" class="nav-link">
  System
</a></li><li class="dropdown-item"><!----> <a href="/system/windows/" class="nav-link">
  Windows
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Front End</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontEnd/" aria-current="page" class="sidebar-link">前端</a></li><li><a href="/frontEnd/ChromeDebugg.html" class="sidebar-link">Chrome 调试技巧</a></li><li><a href="/frontEnd/FullStackDeveloper.html" class="sidebar-link">全栈</a></li><li><a href="/frontEnd/H5.html" class="sidebar-link">H5</a></li><li><a href="/frontEnd/HighPerformanceBrowserNetworking.html" class="sidebar-link">Web 性能权威指南</a></li><li><a href="/frontEnd/compressImage.html" class="sidebar-link">前端图片压缩</a></li><li><a href="/frontEnd/deepUnderstandJavaScript.html" class="sidebar-link">深入理解 javascript</a></li><li><a href="/frontEnd/echarts.html" class="sidebar-link">echarts</a></li><li><a href="/frontEnd/githubPage.html" class="sidebar-link">Github Page</a></li><li><a href="/frontEnd/glsl.html" class="sidebar-link">GLSL 中文手册</a></li><li><a href="/frontEnd/monitor.html" class="sidebar-link">前端监控</a></li><li><a href="/frontEnd/npm.html" class="sidebar-link">npm</a></li><li><a href="/frontEnd/project.html" class="sidebar-link">前端工程</a></li><li><a href="/frontEnd/thingjs.html" class="sidebar-link">thingjs</a></li><li><a href="/frontEnd/uniapp.html" aria-current="page" class="active sidebar-link">Uniapp</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#uniapp-到底如何做用户登录" class="sidebar-link">uniapp 到底如何做用户登录</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#拦截器" class="sidebar-link">拦截器</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#hbuilder" class="sidebar-link">Hbuilder</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#开发注意事项" class="sidebar-link">开发注意事项</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#部署" class="sidebar-link">部署</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#uni-id-用户体系" class="sidebar-link">uni-id 用户体系</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#云函数-云对象" class="sidebar-link">云函数/云对象</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#云数据库" class="sidebar-link">云数据库</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#条件编译" class="sidebar-link">条件编译</a></li><li class="sidebar-sub-header"><a href="/frontEnd/uniapp.html#打包部署" class="sidebar-link">打包部署</a></li></ul></li><li><a href="/frontEnd/vite.html" class="sidebar-link">Vite</a></li><li><a href="/frontEnd/vuecli.html" class="sidebar-link">VueCli</a></li><li><a href="/frontEnd/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/frontEnd/workday.html" class="sidebar-link">工时评估</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="uniapp"><a href="#uniapp" class="header-anchor">#</a> Uniapp</h1> <p>多端应用开发框架, vue2/3</p> <h2 id="uniapp-到底如何做用户登录"><a href="#uniapp-到底如何做用户登录" class="header-anchor">#</a> uniapp 到底如何做用户登录</h2> <p>App.vue 中 <code>onLaunch</code> 生命周期中如果有异步执行, 不能够阻塞页面级 onLoad 方法, 解决方案如下</p> <ol><li><p>https://blog.csdn.net/ltc_Yan/article/details/130851715 巧妙利用 Promise Vue3 版本https://juejin.cn/post/7117586078013341732</p></li> <li><p>预制首页为空白页, 在空白页中处理逻辑</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">setup</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">BACK_URL</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/enums/cacheEnums'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> useUserStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/stores/user'</span>
<span class="token keyword">import</span> cache <span class="token keyword">from</span> <span class="token string">'@/utils/cache'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> onLoad<span class="token punctuation">,</span> onShow <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@dcloudio/uni-app'</span>
<span class="token keyword">const</span> userStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">onShow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// #ifdef MP-WEIXIN</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span>hideHomeButton<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">hideHomeButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'login onLoad'</span><span class="token punctuation">)</span>

  uni<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'请稍后...'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'tenantId'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    userStore<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    uni<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/pages/tenant/tenant'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>userStore<span class="token punctuation">.</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'登录状态已过期,自动登录中...'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> userStore<span class="token punctuation">.</span><span class="token function">codeLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">goPrePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      uni<span class="token punctuation">.</span>$u<span class="token punctuation">.</span><span class="token function">toast</span><span class="token punctuation">(</span><span class="token string">'登录失败, 请退出重试'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">await</span> userStore<span class="token punctuation">.</span><span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">goPrePage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">goPrePage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  uni<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token function">getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>pages<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> prevPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span>
    uni<span class="token punctuation">.</span><span class="token function">navigateBack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// @ts-ignore</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> onLoad<span class="token punctuation">,</span> options <span class="token punctuation">}</span> <span class="token operator">=</span> prevPage
        <span class="token comment">// 刷新上一个页面</span>
        onLoad <span class="token operator">&amp;&amp;</span> <span class="token function">onLoad</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">BACK_URL</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">BACK_URL</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token function">fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        uni<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">url</span><span class="token operator">:</span> cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token constant">BACK_URL</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">reLaunch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/pages/index/index'</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  cache<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token constant">BACK_URL</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <h2 id="拦截器"><a href="#拦截器" class="header-anchor">#</a> 拦截器</h2> <p>uni.addInterceptor() , 通过 Interceptor 实现，https://github.com/dcloudio/uni-app/blob/alpha/src/core/helpers/interceptor.js我们可以看到。
invoke 可以接收一个 promise。那么我们就可以在 invoke 中返回一个 Promise 来处理异步方法</p> <div class="language-js extra-class"><pre class="language-js"><code>uni<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token string">'navigateTo'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>路由拦截只能拦截 uni 对象上路由跳转的方法, 对于 H5 首次进入页面时候拦截不到, 可以使用 app = getApp()身上的$router (uni-app 的 H5 端，自带了 vue.js、vue-router 及部分 es6 polyfill 库，这部分的体积 gzip 后只有 92k，和 web 开发使用 vue 基本一致。)的拦截器, 例如在 setupRouter 中</p></blockquote> <div class="language- extra-class"><pre><code>```js
// #ifdef H5
const app = getApp()
// 非根路径进入应用跳转到登录页
let firstEnter = true
app.$router.beforeEach((to, from, next) =&gt; {
  if (firstEnter &amp;&amp; to.path !== '/') {
    cache.set(BACK_URL, to.fullPath)
    next('/pages/login/login')  // 跳转到登录页
  } else {
    next()
  }
  firstEnter = false
})
// #endif
```
</code></pre></div><h2 id="hbuilder"><a href="#hbuilder" class="header-anchor">#</a> Hbuilder</h2> <p>开发工具, 新建项目 选择模板即可</p> <ul><li>uni-starter 集成商用项目常见功能的、云端一体应用快速开发项目模版。</li> <li>uni-admin 后台管理系统模板</li></ul> <h2 id="开发注意事项"><a href="#开发注意事项" class="header-anchor">#</a> 开发注意事项</h2> <ul><li>使用 uni-cli 创建的项目在选定 uniapp 版本后， 建议 package.json 中锁定 uni 框架包版本</li> <li>跨端方面 https://uniapp.dcloud.net.cn/matter.html</li> <li>工程目录方面 在 page 目录下<code>新建一个页面目录，然后创建一个目录同名的.vue文件</code>, 自定义组件：放到 component 目录(会被 easycom 解析)</li> <li>h5 开发注意事项：https://uniapp.dcloud.net.cn/matter.html#h5-%E5%BC%80%E5%8F%91%E6%B3%A8%E6%84%8F 引用第三方 js 的方式, h5 导航栏问题</li> <li>小程序开发注意： https://uniapp.dcloud.net.cn/matter.html#mp</li></ul> <h2 id="部署"><a href="#部署" class="header-anchor">#</a> 部署</h2> <ul><li>部署教程 https://uniapp.dcloud.net.cn/quickstart-hx.html#%E5%8F%91%E5%B8%83uni-app</li></ul> <h2 id="uni-id-用户体系"><a href="#uni-id-用户体系" class="header-anchor">#</a> uni-id 用户体系</h2> <p>uni-id-pages，是 uni-id 体系的一部分。</p> <h2 id="云函数-云对象"><a href="#云函数-云对象" class="header-anchor">#</a> 云函数/云对象</h2> <p>在 unicloud/cloudfunctions 目录中,使用 commonjs 规范, 目录中 右击 <code>新建云函数</code></p> <h3 id="云函数"><a href="#云函数" class="header-anchor">#</a> 云函数</h3> <p>生成一个目录,目录下自动生成 index.js 不可改名。代码运行在云端 nodejs 中</p> <h4 id="说明"><a href="#说明" class="header-anchor">#</a> 说明</h4> <ul><li>可以在云函数中执行任意 nodejs 支持的操作, 可以安装依赖库, 可以在这个 js 中 require 该云函数目录下的其他 js、json 文件。</li> <li>unicloud 的云函数环境<code>内置了uniCloud对象</code> 对象内置了网络,数据库等各种 API <a href="https://uniapp.dcloud.net.cn/uniCloud/cf-functions.html#unicloud-api%E5%88%97%E8%A1%A8">API 详细</a></li> <li>每个云函数是一个 js 包，在云函数被调用时，由 serverless 调度系统分配硬件资源启动一个 node 环境来运行这个云函数。</li> <li>云函数启动后实例会保留一段时间（如 15 分钟），超过保留期后若该云函数一直没有被再调用，那这个实例会被释放。所以云函数有冷启动的概念。不过由于 js 实例的启动要比 php 和 java 更快，所以 js 更适合 serverless 方式。</li> <li>使用 <code>uniCloud.callfunction(&quot;&quot;)</code> 调用</li> <li>云函数 URL 化: 可以让云函数/云对象生成一个 HTTP URL。这样非 uni-app 应用，可以通过 ajax 请求和云函数/云对象通信</li></ul> <h3 id="云对象"><a href="#云对象" class="header-anchor">#</a> 云对象</h3> <p>生成一个目录, 目录下自动生成 index.obj.js 不可改名。</p> <ul><li>前端代码调用云对象:<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> helloco <span class="token operator">=</span> uniCloud<span class="token punctuation">.</span><span class="token function">importObject</span><span class="token punctuation">(</span><span class="token string">'helloco'</span><span class="token punctuation">)</span> <span class="token comment">// 导入云对象</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> helloco<span class="token punctuation">.</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//导入云对象后就可以直接调用该对象的sum方法了，注意使用异步await</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">// 结果是3</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="公共模块"><a href="#公共模块" class="header-anchor">#</a> 公共模块</h3> <p>uniCloud/cloudfunctions/common 目录</p> <p>用于不同的云函数/云对象，抽取和共享相同代码</p> <h2 id="云数据库"><a href="#云数据库" class="header-anchor">#</a> 云数据库</h2> <p>使用 clientDb 客户端可以直接操作云数据库: 通过<code>&lt;uniCloud-db&gt;</code>组件或 uniCloud.database() API 来访问 uniCloud 数据库。也支持搭配 action 云函数追加服务器逻辑</p> <h2 id="条件编译"><a href="#条件编译" class="header-anchor">#</a> 条件编译</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// #ifdef H5</span>

<span class="token comment">/// #endif</span>
</code></pre></div><h2 id="打包部署"><a href="#打包部署" class="header-anchor">#</a> 打包部署</h2> <h3 id="跨端应用-ajax-前缀路径设置"><a href="#跨端应用-ajax-前缀路径设置" class="header-anchor">#</a> 跨端应用 ajax 前缀路径设置</h3> <p>一种是代码托管需要我们自己放在 web 容器中, 然后在平台上或者告诉用户我们应用的地址, ajax 前缀直接设置成'/' 即可</p> <p>另一种是微信小程序那样代码托管在平台中, 需要将 ajax 前缀设置成我们的网关等正确的地址</p> <p>uniapp 默认只有两个环境, 一个是运行(开发)环境, 一个是发行(正式)环境, 对于一套系统会有测试、正式环境, uni-app 提供了小程序/h5 端解决方案</p> <blockquote><p>https://uniapp.dcloud.net.cn/collocation/package.html</p></blockquote> <blockquote><p>https://blog.csdn.net/wangjun5159/article/details/124110108</p></blockquote></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/frontEnd/thingjs.html" class="prev">
        thingjs
      </a></span> <span class="next"><a href="/frontEnd/vite.html">
        Vite
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.bdff9417.js" defer></script><script src="/assets/js/2.877b15ed.js" defer></script><script src="/assets/js/1.ee4b0e89.js" defer></script><script src="/assets/js/55.94df427b.js" defer></script>
  </body>
</html>
