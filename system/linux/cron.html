<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>cron 定时任务 | HeroKing的个人笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link href="https://cdn.bootcdn.net/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet">
    <script src="https://hm.baidu.com/hm.js?3691b93bb6fcef0775ef18a936452b97" defer="true"></script>
    <meta name="description" content="学习犹如逆水行舟,不进则退">
    
    <link rel="preload" href="/assets/css/0.styles.4fe2b2c9.css" as="style"><link rel="preload" href="/assets/js/app.dbc686cd.js" as="script"><link rel="preload" href="/assets/js/2.eac21ce5.js" as="script"><link rel="preload" href="/assets/js/1.45e828d6.js" as="script"><link rel="preload" href="/assets/js/93.36b35fb4.js" as="script"><link rel="prefetch" href="/assets/js/10.6765a954.js"><link rel="prefetch" href="/assets/js/100.fe1a6ec6.js"><link rel="prefetch" href="/assets/js/11.8bb82943.js"><link rel="prefetch" href="/assets/js/12.01809d41.js"><link rel="prefetch" href="/assets/js/13.09068d54.js"><link rel="prefetch" href="/assets/js/14.bb26fb6e.js"><link rel="prefetch" href="/assets/js/15.9182b3c7.js"><link rel="prefetch" href="/assets/js/16.166da1a0.js"><link rel="prefetch" href="/assets/js/17.80a018c6.js"><link rel="prefetch" href="/assets/js/18.c1668785.js"><link rel="prefetch" href="/assets/js/19.eeeabde6.js"><link rel="prefetch" href="/assets/js/20.5f9c01e4.js"><link rel="prefetch" href="/assets/js/21.42b62d3a.js"><link rel="prefetch" href="/assets/js/22.3b887cc7.js"><link rel="prefetch" href="/assets/js/23.d1f0435a.js"><link rel="prefetch" href="/assets/js/24.66861e00.js"><link rel="prefetch" href="/assets/js/25.58dc40c5.js"><link rel="prefetch" href="/assets/js/26.530b82b9.js"><link rel="prefetch" href="/assets/js/27.671e8f86.js"><link rel="prefetch" href="/assets/js/28.a025ec3f.js"><link rel="prefetch" href="/assets/js/29.56aee928.js"><link rel="prefetch" href="/assets/js/3.745c9486.js"><link rel="prefetch" href="/assets/js/30.efbefddd.js"><link rel="prefetch" href="/assets/js/31.a7f92165.js"><link rel="prefetch" href="/assets/js/32.cc6bc473.js"><link rel="prefetch" href="/assets/js/33.5a0d7935.js"><link rel="prefetch" href="/assets/js/34.241a587f.js"><link rel="prefetch" href="/assets/js/35.24e5c0f3.js"><link rel="prefetch" href="/assets/js/36.d39f15d6.js"><link rel="prefetch" href="/assets/js/37.10073ad8.js"><link rel="prefetch" href="/assets/js/38.488023b4.js"><link rel="prefetch" href="/assets/js/39.46a6961d.js"><link rel="prefetch" href="/assets/js/4.74a062a6.js"><link rel="prefetch" href="/assets/js/40.028a8398.js"><link rel="prefetch" href="/assets/js/41.bf449de4.js"><link rel="prefetch" href="/assets/js/42.90604587.js"><link rel="prefetch" href="/assets/js/43.9ccd38e1.js"><link rel="prefetch" href="/assets/js/44.8d712ba8.js"><link rel="prefetch" href="/assets/js/45.08008593.js"><link rel="prefetch" href="/assets/js/46.dc289880.js"><link rel="prefetch" href="/assets/js/47.af46daac.js"><link rel="prefetch" href="/assets/js/48.bcadcb04.js"><link rel="prefetch" href="/assets/js/49.d36b1513.js"><link rel="prefetch" href="/assets/js/5.c6edbe4c.js"><link rel="prefetch" href="/assets/js/50.39cbba95.js"><link rel="prefetch" href="/assets/js/51.6b877498.js"><link rel="prefetch" href="/assets/js/52.991dfa97.js"><link rel="prefetch" href="/assets/js/53.5aa5c796.js"><link rel="prefetch" href="/assets/js/54.7e83e4fb.js"><link rel="prefetch" href="/assets/js/55.7cef0c39.js"><link rel="prefetch" href="/assets/js/56.54e20409.js"><link rel="prefetch" href="/assets/js/57.9d54949d.js"><link rel="prefetch" href="/assets/js/58.2d780311.js"><link rel="prefetch" href="/assets/js/59.b0ab8a8c.js"><link rel="prefetch" href="/assets/js/6.c83fdbd0.js"><link rel="prefetch" href="/assets/js/60.8b5b71fb.js"><link rel="prefetch" href="/assets/js/61.92ca9a04.js"><link rel="prefetch" href="/assets/js/62.05e7f842.js"><link rel="prefetch" href="/assets/js/63.54508338.js"><link rel="prefetch" href="/assets/js/64.10b5b748.js"><link rel="prefetch" href="/assets/js/65.8aaec075.js"><link rel="prefetch" href="/assets/js/66.75cd08b8.js"><link rel="prefetch" href="/assets/js/67.f4530b2f.js"><link rel="prefetch" href="/assets/js/68.cd13aff5.js"><link rel="prefetch" href="/assets/js/69.ee335487.js"><link rel="prefetch" href="/assets/js/7.4ac7aa67.js"><link rel="prefetch" href="/assets/js/70.0c23693c.js"><link rel="prefetch" href="/assets/js/71.f78cc92b.js"><link rel="prefetch" href="/assets/js/72.929ad236.js"><link rel="prefetch" href="/assets/js/73.5cbd6529.js"><link rel="prefetch" href="/assets/js/74.41754f92.js"><link rel="prefetch" href="/assets/js/75.d8dc1d1e.js"><link rel="prefetch" href="/assets/js/76.354c0628.js"><link rel="prefetch" href="/assets/js/77.470fb027.js"><link rel="prefetch" href="/assets/js/78.1c6e2674.js"><link rel="prefetch" href="/assets/js/79.3c42e8ef.js"><link rel="prefetch" href="/assets/js/80.d5d9d73f.js"><link rel="prefetch" href="/assets/js/81.019edaf1.js"><link rel="prefetch" href="/assets/js/82.bcf811ec.js"><link rel="prefetch" href="/assets/js/83.ec6b27a7.js"><link rel="prefetch" href="/assets/js/84.74be5017.js"><link rel="prefetch" href="/assets/js/85.dbd8c232.js"><link rel="prefetch" href="/assets/js/86.04140380.js"><link rel="prefetch" href="/assets/js/87.1febc91a.js"><link rel="prefetch" href="/assets/js/88.112a9655.js"><link rel="prefetch" href="/assets/js/89.bf8a2aed.js"><link rel="prefetch" href="/assets/js/90.f7f5adda.js"><link rel="prefetch" href="/assets/js/91.6a6d6923.js"><link rel="prefetch" href="/assets/js/92.13de53bc.js"><link rel="prefetch" href="/assets/js/94.5e115d3b.js"><link rel="prefetch" href="/assets/js/95.b886a162.js"><link rel="prefetch" href="/assets/js/96.3b74dcba.js"><link rel="prefetch" href="/assets/js/97.6c3ca067.js"><link rel="prefetch" href="/assets/js/98.35f5298d.js"><link rel="prefetch" href="/assets/js/99.9416486d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.f7f71fb4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4fe2b2c9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HeroKing的个人笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="afterEnd" class="dropdown-title"><span class="title">afterEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="afterEnd" class="mobile-dropdown-title"><span class="title">afterEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/afterEnd/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/JMS/" class="nav-link">
  JMS
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/" class="nav-link">
  After End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithms" class="dropdown-title"><span class="title">algorithms</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithms" class="mobile-dropdown-title"><span class="title">algorithms</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  Algorithms
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontEnd" class="dropdown-title"><span class="title">frontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontEnd" class="mobile-dropdown-title"><span class="title">frontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/autojs/" class="nav-link">
  Autojs
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/demo/" class="nav-link">
  Demo
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/" class="nav-link">
  Front End
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/ts/" class="nav-link">
  Ts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="life" class="dropdown-title"><span class="title">life</span> <span class="arrow down"></span></button> <button type="button" aria-label="life" class="mobile-dropdown-title"><span class="title">life</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/" class="nav-link">
  Life
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="network" class="dropdown-title"><span class="title">network</span> <span class="arrow down"></span></button> <button type="button" aria-label="network" class="mobile-dropdown-title"><span class="title">network</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/network/proxy/" class="nav-link">
  Proxy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="software" class="dropdown-title"><span class="title">software</span> <span class="arrow down"></span></button> <button type="button" aria-label="software" class="mobile-dropdown-title"><span class="title">software</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/software/ftp/" class="nav-link">
  Ftp
</a></li><li class="dropdown-item"><!----> <a href="/software/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/software/samba/" class="nav-link">
  Samba
</a></li><li class="dropdown-item"><!----> <a href="/software/" class="nav-link">
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="system" class="dropdown-title"><span class="title">system</span> <span class="arrow down"></span></button> <button type="button" aria-label="system" class="mobile-dropdown-title"><span class="title">system</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/system/Hackintosh/" class="nav-link">
  Hackintosh
</a></li><li class="dropdown-item"><!----> <a href="/system/linux/" class="nav-link router-link-active">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/system/" class="nav-link router-link-active">
  System
</a></li><li class="dropdown-item"><!----> <a href="/system/windows/" class="nav-link">
  Windows
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="afterEnd" class="dropdown-title"><span class="title">afterEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="afterEnd" class="mobile-dropdown-title"><span class="title">afterEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/afterEnd/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/JMS/" class="nav-link">
  JMS
</a></li><li class="dropdown-item"><!----> <a href="/afterEnd/" class="nav-link">
  After End
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="algorithms" class="dropdown-title"><span class="title">algorithms</span> <span class="arrow down"></span></button> <button type="button" aria-label="algorithms" class="mobile-dropdown-title"><span class="title">algorithms</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/" class="nav-link">
  Algorithms
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="frontEnd" class="dropdown-title"><span class="title">frontEnd</span> <span class="arrow down"></span></button> <button type="button" aria-label="frontEnd" class="mobile-dropdown-title"><span class="title">frontEnd</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontEnd/autojs/" class="nav-link">
  Autojs
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/css/" class="nav-link">
  Css
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/demo/" class="nav-link">
  Demo
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/" class="nav-link">
  Front End
</a></li><li class="dropdown-item"><!----> <a href="/frontEnd/ts/" class="nav-link">
  Ts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="life" class="dropdown-title"><span class="title">life</span> <span class="arrow down"></span></button> <button type="button" aria-label="life" class="mobile-dropdown-title"><span class="title">life</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/life/" class="nav-link">
  Life
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="network" class="dropdown-title"><span class="title">network</span> <span class="arrow down"></span></button> <button type="button" aria-label="network" class="mobile-dropdown-title"><span class="title">network</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">
  Network
</a></li><li class="dropdown-item"><!----> <a href="/network/proxy/" class="nav-link">
  Proxy
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="software" class="dropdown-title"><span class="title">software</span> <span class="arrow down"></span></button> <button type="button" aria-label="software" class="mobile-dropdown-title"><span class="title">software</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/software/ftp/" class="nav-link">
  Ftp
</a></li><li class="dropdown-item"><!----> <a href="/software/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/software/samba/" class="nav-link">
  Samba
</a></li><li class="dropdown-item"><!----> <a href="/software/" class="nav-link">
  Software
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="system" class="dropdown-title"><span class="title">system</span> <span class="arrow down"></span></button> <button type="button" aria-label="system" class="mobile-dropdown-title"><span class="title">system</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/system/Hackintosh/" class="nav-link">
  Hackintosh
</a></li><li class="dropdown-item"><!----> <a href="/system/linux/" class="nav-link router-link-active">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/system/" class="nav-link router-link-active">
  System
</a></li><li class="dropdown-item"><!----> <a href="/system/windows/" class="nav-link">
  Windows
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Linux</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/linux/" aria-current="page" class="sidebar-link">Linux</a></li><li><a href="/system/linux/armbian.html" class="sidebar-link">armbian</a></li><li><a href="/system/linux/commandList.html" class="sidebar-link">linux 常用命令</a></li><li><a href="/system/linux/cron.html" aria-current="page" class="active sidebar-link">cron 定时任务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/system/linux/cron.html#cron-crontab-以及-anacron-的关系" class="sidebar-link">cron，crontab 以及 anacron 的关系</a></li><li class="sidebar-sub-header"><a href="/system/linux/cron.html#crontab-命令-crontab-文件语法" class="sidebar-link">crontab 命令，crontab 文件语法</a></li><li class="sidebar-sub-header"><a href="/system/linux/cron.html#限制可以使用-cron-的用户" class="sidebar-link">限制可以使用 cron 的用户</a></li><li class="sidebar-sub-header"><a href="/system/linux/cron.html#用-anacron-执行周期性的任务" class="sidebar-link">用 anacron 执行周期性的任务</a></li><li class="sidebar-sub-header"><a href="/system/linux/cron.html#run-parts" class="sidebar-link">run-parts</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="cron-定时任务"><a href="#cron-定时任务" class="header-anchor">#</a> cron 定时任务</h1> <blockquote><p>https://www.cnblogs.com/zhoul/p/9931664.html<br>
在 linux 下，如果想要在未来的某个时刻执行某个任务，并且在未来的每一个这样的时刻里都要执行这个任务。举个简单的例子，比如说想要在将来，
每天的十二点都重启路由器，大多数发行版都自带一个守护进程（daemon）cron 来完成这项工作。这篇文章主要介绍了在 linux 上定期执行命令、脚本
（cron，crontab，anacron）的相关知识</p></blockquote> <h2 id="cron-crontab-以及-anacron-的关系"><a href="#cron-crontab-以及-anacron-的关系" class="header-anchor">#</a> cron，crontab 以及 anacron 的关系</h2> <p>cron 是大多数 linux 发行版都自带的守护进程（daemon），用来重复运行某些被设定好了确定的运行时间的任务，这些任务可以是每个月运行、每周运行、每天运行，
甚至是每一分钟运行。用 cron 执行的任务适合于 24 小时运行的机器，cron 执行的任务会在设定好的时刻执行，当机器处于关机状态下并错过了任务执行的时间，
cron 任务就无法预期执行了。
crontab(cron table 的简称)既可以指 cron 用来定期执行特定任务所需要的列表文件，又可以指用来创建、删除、查看当前用户（或者指定用户）的 crontab 文件的命令。</p> <p>anacron 不是守护进程，可以看做是 cron 守护进程的某种补充程序，anacron 是独立的 linux 程序，被 cron 守护进程或者其他开机脚本启动运行，可以每天、每周、
每个月周期性地执行一项任务（最小单位为天）。适合于可能经常会关机的机器，当机器重新开机 anacron 程序启动之后，
anacron 会检查 anacron 任务是否在合适的周期执行了，如果未执行则在 anacron 设定好的延迟时间之后只执行一次任务，而不管任务错过了几次周期。
举个例子，比如你设定了一个每周备份文件的任务，但是你的电脑因为你外出度假而处于关机状态四周，当你回到家中开机后，anacron 会在延迟一定时间之后只备份一次文件。由于发行版的不同，cron 守护进程如何运行 anacron 会有所不同。</p> <h2 id="crontab-命令-crontab-文件语法"><a href="#crontab-命令-crontab-文件语法" class="header-anchor">#</a> crontab 命令，crontab 文件语法</h2> <p>系统默认 crontab 文件为/etc/crontab,以及/etc/cron.d/目录下的文件，有些程序会把自己的 crontab 文件放在/etc/cron.d/目录下。
要修改/etc/crontab 以及/etc/cron.d/目录下的文件需要 root 权限。cron 守护进程会检查/etc/crontab 以及/etc/cron.d/目录下的文件，
根据这些文件中的 cron 任务所设置的执行时间决定是否执行任务，如果当前时间与 cron 任务所设置的执行时间相同，则执行任务。</p> <p>每个用户自己的 crontab 文件都会被放在 /var/spool/cron 目录下，默认为空，可以使用 crontab 命令创建。
cron 守护进程会检查/var/spool/cron 目录下的文件，根据这些文件中的 cron 任务所设置的执行时间决定是否执行任务，
如果当前时间与 cron 任务所设置的执行时间相同，则执行任务。</p> <p>当 cron 的配置文件发生改变时，不需要重置 cron 守护进程。cron 守护进程会检查配置文件的变化。</p> <p>创建自己的 crontab 之前，首先要设置环境变量 EDITOR,cron 进程根据它来确定使用哪个编辑器编辑 crontab 文件。
在 home 目录下的.bashrc 或者.profile 里加入一行 #你也可以使用自己喜爱的其他终端编辑器
EDITOR=vim; export EDITOR</p> <p>使用 crontab -h 查看帮助
当用 crontab -e <strong>编辑当前用户的 crontab 文件时，首先写入以下内容</strong>。
1 # crontab -e
2 SHELL=/bin/bash
3 MAILTO=root@example.com
4 PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin
5
6 # For details see man 4 crontabs
7
8 # Example of job definition:
9 # .---------------- minute (0 - 59)
10 # | .------------- hour (0 - 23)
11 # | | .---------- day of month (1 - 31)
12 # | | | .------- month (1 - 12) OR jan,feb,mar,apr ...
13 # | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat
14 # | | | | |
15 # * * * * * user-name command to be executed</p> <p>该文件的前三行代码设置了默认环境。cron 守护进程并不提供任何环境。SHELL 变量设置当 cron 任务(命令以及脚本)运行时的 shell,
MAILTO 变量设置 cron 任务执行结果发送的邮箱，PATH 设置去哪些目录下寻找 cron 任务的命令。
注释部分则解释一条 cron 任务的构成，一条 cron 任务就是一行，要设置多少条 cron 任务则写多少行。一条 cron 任务由七个部分组成，从左到右依次为：</p> <p>分钟（0-59）
小时（0-23）
天（1-31）
月 （1-12）：或者可以使用月份的英文单词的前三个字母，比如 jan,feb,mar,apr...
星期（0-6）：星期天用 0 或者 7 都可以，或者可以使用星期的英文单词的前三个字母，比如 sun,mon,tue,wed,thu,fri,sat
用户名称（可以省略）
要执行的命令或者脚本目录
前五个部分的编写注意特殊符号的含义：</p> <p>如果你想匹配取值范围内的所有值，使用“<em>”
想匹配某些特殊的值，使用“,”，比如 2,4,7 就匹配的是 2，4 以及 7。
两个值被“-”连接表示范围，此时匹配的是范围内所有值，包含“-”两边的值，比如 4-7 匹配的就是从 4 到 7。
想要表达每隔一段时间执行一次任务，使用 “/”， 比如分钟部分中的 “</em>/10”表示每 10 分钟运行一次，比如小时部分中的“10-22/2”则表示在早上 10 点到晚上 10 点这段时间内，每隔两个小时运行一次。 注意 ：当“/”左边的值可以除尽“/”右边的值时，任务才会运行。</p> <p>举例：
每天凌晨执行
0 0 * * * root command</p> <p>每周星期天早上五点执行
0 5 * * sun root command</p> <p>每个月的前 10 天晚上 10 点开始每隔 10 分钟执行一次命令
_/10 22 1-10 _ * root command</p> <p>从星期一到五，每个小时的第 10 分钟、第 20 分钟以及第 30 分钟都执行一次命令
10,20,30 * * * 1-5 root command</p> <p>特殊简便写法：
@hourly 代表 0 * * * _ ，每个小时运行一次
@daily 代表 0 0 _ * _ ，每天凌晨运行一次
@weekly 代表 0 0 _ _ 0 ，每周星期天凌晨运行一次
@monthly 代表 0 0 1 _ _ ，每个月第一天凌晨运行一次
@yearly 代表 0 0 1 1 _ ，每年的头一分钟运行一次
@reboot 重启后执行一次</p> <p>你可以把需要每个小时运行一次的脚本放到/etc/cron.hourly 目录下，cron 守护进程会每个小时都运行一次。
当然/etc 下面还有 cron.daily/ cron.hourly/ cron.monthly/ weekly/</p> <h2 id="限制可以使用-cron-的用户"><a href="#限制可以使用-cron-的用户" class="header-anchor">#</a> 限制可以使用 cron 的用户</h2> <p>在/etc/目录下，可能默认会有 cron.allow 以及 cron.deny 文件，也可能没有，没有的情况下可以自己创建，cron.allow 文件包含了可以使用 cron 的用户名，cron.deny 文件包含了不可以使用 cron 的用户名。两个文件中每个用户名占一行，并且不允许出现空格。</p> <p>root 用户在任何情况下都可以使用 cron。</p> <p>假如 cron.allow 存在，则只有列在这个文件中的用户名可以使用 cron,这时候 cron.deny 被忽视。</p> <p>假如 cron.allow 不存在，则列在 cron.deny 文件中的用户名不可以使用 cron。</p> <h2 id="用-anacron-执行周期性的任务"><a href="#用-anacron-执行周期性的任务" class="header-anchor">#</a> 用 anacron 执行周期性的任务</h2> <p>anacron 程序可以周期性的执行任务，但具体执行时间并不确定。可以每天、每周、每个月周期性的执行任务。当 anacron 的配置文件发生改变时，下一次 anacron 运行时会检查到配置文件的变化。anacron 的配置文件为/etc/anacrontab,编辑需要 root 权限，默认以下内容：</p> <div class="language- extra-class"><pre class="language-text"><code># See anacron(8) and anacrontab(5) for details.
SHELL=/bin/sh
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
# the maximal random delay added to the base delay of the jobs
RANDOM_DELAY=45
# the jobs will be started during the following hours only
START_HOURS_RANGE=3-22
#period in days delay in minutes job-identifier command
1  5  cron.daily    nice run-parts /etc/cron.daily
7  25  cron.weekly    nice run-parts /etc/cron.weekly
@monthly 45  cron.monthly   nice run-parts /etc/cron.monthly
可以看到前三行设置了默认环境，RANDOM_DELAY变量设置了最大延迟执行时间，START_HOURS_RANGE变量设置了anacron任务执行的时间范围，默认在每天的3点到22点之间。最后三行则设置了三条默认的anacron任务，分别是每天执行，每周执行，每月执行。
</code></pre></div><h3 id="anacron-文件语法"><a href="#anacron-文件语法" class="header-anchor">#</a> anacron 文件语法</h3> <p>观察前面三条默认的 anacron 任务，可以看到一条 anacron 任务分为四个部分，从左到右依次为：</p> <p>周期（天）：设置任务执行的频率，以 天数 为单位，写 1 则代表每天执行，写 3 则代表每 3 天执行，可以使用特殊符号“@”， @daily 代表每天， @weekly 代表每周， @monthly 代表每月。
延迟时间：设置任务的延迟时间，以 分钟 为单位，比如写 5，则当 anacron 启动后，anacron 等待 5 分钟就会执行该任务。设置延迟时间是为了当机器启动时不会因为执行很多 anacron 任务而过载。
任务标识：其目的是识别消息，日志文件和执行特殊操作。
要执行的命令
在/etc/anacrontab 中的三条默认 anacron 任务中，nice 命令用来调整后面命令的优先级，run-parts 命令用来执行设置的目录下的所有脚本，就是说这三条任务分别每天，每周，每月执行/etc/cron.daily，/etc/cron.weekly，/etc/cron.monthly 目录下的脚本。所以我们不用自己往/etc/anacrontab 中添加 anacrontab 任务，而只需把脚本放到相应的目录下，anacron 就会周期性的执行这些脚本了。</p> <h3 id="_3-2-anacron-如何运行"><a href="#_3-2-anacron-如何运行" class="header-anchor">#</a> 3.2.anacron 如何运行</h3> <p>既然 anacron 不是守护进程，那它是如何做到周期性执行任务的呢？在 centos7 下，cron 会运行/etc/cron.d/0hourly，在/etc/cron.d/0hourly 文件里，
有一条 cron 任务是这样的：
01 * * * * root run-parts /etc/cron.hourly
这条 cron 任务会运行/etc/cron.hourly 目录下的所有脚本，其中有一个名为 0anacron 的脚本，该脚本则会在合适的时间运行 anacron,
anacron 则会检查/etc/anacrontab,在合适的时间分别运行/etc/cron.daily，/etc/cron.weekly，/etc/cron.monthly 目录下的脚本。</p> <p>系统建立的时间任务配置文件：
vim /etc/crontab 记录“系统中”默认定义的一些计划任务。
SHELL=/bin/bash
PATH=/sbin:/bin:/usr/sbin:/usr/bin
MAILTO=root
HOME=/</p> <h2 id="run-parts"><a href="#run-parts" class="header-anchor">#</a> run-parts</h2> <p>01 * * * _ root run-parts /etc/cron.hourly
02 4 _ * _ root run-parts /etc/cron.daily
22 4 _ _ 0 root run-parts /etc/cron.weekly
42 4 1 _ * root run-parts /etc/cron.monthly</p> <ul><li><ul><li><ul><li><ul><li><ul><li>root /bin/echo &quot;111111111&quot; &gt; /dev/pts/0 （直接写命令）</li></ul></li></ul></li></ul></li></ul></li> <li><ul><li><ul><li><ul><li><ul><li>root /test/dir1/test.sh （运行单个脚本）</li></ul></li></ul></li></ul></li></ul></li> <li><ul><li><ul><li><ul><li><ul><li>root run-parts /test/dir1 （运行目录下的所有可执行程序）</li></ul></li></ul></li></ul></li></ul></li></ul> <p>注意，写在这里的时间任务必须指明 运行该命令的用户身份
一般都是 root
run-parts:可以执行某个目录下的所有脚本文件</p> <blockquote><p>Linux 进行工作排程的种类有两种，
at 是执行突发性的 乐意处理并执行一次就结束的，依赖于 atd 这个服务
crontab 这个指令是周期性的 也可以编辑文件
Linux 中有很多的周期性工作要做的 比如周期更新 locate 数据库，文件位于/var/lib/mlocate</p></blockquote> <div class="language- extra-class"><pre><code>比如RPM登陆文件的建立
</code></pre></div><p>At 设置好的定时任务 可以通过 atq 查询，通过 atrm 删除</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/system/linux/commandList.html" class="prev">
        linux 常用命令
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dbc686cd.js" defer></script><script src="/assets/js/2.eac21ce5.js" defer></script><script src="/assets/js/1.45e828d6.js" defer></script><script src="/assets/js/93.36b35fb4.js" defer></script>
  </body>
</html>
